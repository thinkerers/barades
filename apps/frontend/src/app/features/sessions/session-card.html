<article
  class="session-card"
  [class]="'session-card--' + session.tagColor.toLowerCase()"
  >
  <!-- Tag Color Indicator -->
  <div
    class="session-card__tag"
    [ngClass]="getTagColorClass(session.tagColor)"
  ></div>

  <!-- Header -->
  <header class="session-card__header">
    <h3 class="session-card__title">{{ session.title }}</h3>
    <span class="session-card__game">{{ session.game }}</span>
  </header>

  <!-- Status Badges -->
  <div class="session-card__badges">
    <div class="session-card__status" [ngClass]="getStatusClass()">
      @if (!isFull()) {
        <span
          >{{ getAvailableSpots() }} place(s) disponible(s)</span
          >
        }
        @if (isFull()) {
          <span>Complet</span>
        }
      </div>
      @if (isRegistered) {
        <div class="session-card__registered">
          <mat-icon>check_circle</mat-icon> Inscrit
        </div>
      }
    </div>

    <!-- Details -->
    <div class="session-card__details">
      <!-- Date -->
      <div class="session-card__detail">
        <mat-icon>event</mat-icon>
        <span>{{ formatDate(session.date) }}</span>
      </div>

      <!-- Host -->
      @if (session.host) {
        <div class="session-card__detail">
          <mat-icon>person</mat-icon>
          <span>{{ session.host.username }}</span>
        </div>
      }

      <!-- Location -->
      @if (session.location) {
        <div class="session-card__detail">
          <mat-icon>place</mat-icon>
          <span>{{ session.location.name }}, {{ session.location.city }}</span>
        </div>
      }

      <!-- Online indicator -->
      @if (session.online) {
        <div class="session-card__detail">
          <mat-icon>computer</mat-icon>
          <span>En ligne</span>
        </div>
      }

      <!-- Level -->
      <div class="session-card__detail">
        <mat-icon>trending_up</mat-icon>
        <span>{{ getLevelLabel(session.level) }}</span>
      </div>

      <!-- Players -->
      <div class="session-card__detail session-card__detail--players">
        <mat-icon>groups</mat-icon>
        <span>
          <strong>{{ session.playersCurrent }}/{{ session.playersMax }}</strong>
          joueurs
        </span>
      </div>
    </div>

    <!-- Description -->
    @if (session.description) {
      <p class="session-card__description">
        {{ session.description }}
      </p>
    }

    <!-- Actions -->
    <footer class="session-card__actions">
      <button
        type="button"
        class="button button--primary"
        [disabled]="isFull() || loading || isRegistered"
        [class.button--success]="isRegistered"
        (click)="onReserve()"
        >
        @if (loading) {
          <span>Réservation...</span>
        }
        @if (!loading && isRegistered) {
          <span
            ><mat-icon>check</mat-icon> Déjà inscrit</span
            >
          }
          @if (!loading && !isRegistered) {
            <span
              >{{ isFull() ? 'Complet' : 'Réserver ma place' }}</span
              >
            }
          </button>
          <a
            [routerLink]="['/sessions', session.id]"
            class="button button--secondary"
            >
            Voir détails
          </a>
        </footer>
      </article>
