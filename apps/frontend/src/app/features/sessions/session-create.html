<div class="create-session-page">
  <header class="create-session-page__header">
    <h1>Créer une nouvelle session</h1>
    <p>Organisez une partie de jeu de rôle et invitez la communauté</p>
  </header>

  <form [formGroup]="sessionForm" (ngSubmit)="onSubmit()" class="session-form">
    <!-- Error Message -->
    <div *ngIf="error" class="error-message">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      {{ error }}
    </div>

    <!-- Game & Title -->
    <div class="form-row">
      <div class="form-group">
        <label for="game">
          Système de jeu <span class="required">*</span>
        </label>
        <input
          type="text"
          id="game"
          formControlName="game"
          placeholder="ex: Dungeons & Dragons 5e, Pathfinder..."
          [class.error]="sessionForm.get('game')?.touched && sessionForm.get('game')?.invalid"
        />
        <span class="error-text" *ngIf="sessionForm.get('game')?.touched && sessionForm.get('game')?.invalid">
          {{ getErrorMessage('game') }}
        </span>
      </div>

      <div class="form-group">
        <label for="title">
          Titre de la session <span class="required">*</span>
        </label>
        <input
          type="text"
          id="title"
          formControlName="title"
          placeholder="ex: Les Mines de Phandelver - Chapitre 1"
          [class.error]="sessionForm.get('title')?.touched && sessionForm.get('title')?.invalid"
        />
        <span class="error-text" *ngIf="sessionForm.get('title')?.touched && sessionForm.get('title')?.invalid">
          {{ getErrorMessage('title') }}
        </span>
      </div>
    </div>

    <!-- Description -->
    <div class="form-group">
      <label for="description">Description</label>
      <textarea
        id="description"
        formControlName="description"
        rows="4"
        placeholder="Décrivez votre session, l'ambiance, ce qui attend les joueurs..."
      ></textarea>
    </div>

    <!-- Date & Players -->
    <div class="form-row">
      <div class="form-group">
        <label for="date">
          Date et heure <span class="required">*</span>
        </label>
        <input
          type="datetime-local"
          id="date"
          formControlName="date"
          [class.error]="sessionForm.get('date')?.touched && sessionForm.get('date')?.invalid"
        />
        <span class="error-text" *ngIf="sessionForm.get('date')?.touched && sessionForm.get('date')?.invalid">
          {{ getErrorMessage('date') }}
        </span>
      </div>

      <div class="form-group">
        <label for="playersMax">
          Nombre de joueurs max <span class="required">*</span>
        </label>
        <input
          type="number"
          id="playersMax"
          formControlName="playersMax"
          min="2"
          max="12"
          [class.error]="sessionForm.get('playersMax')?.touched && sessionForm.get('playersMax')?.invalid"
        />
        <span class="error-text" *ngIf="sessionForm.get('playersMax')?.touched && sessionForm.get('playersMax')?.invalid">
          {{ getErrorMessage('playersMax') }}
        </span>
      </div>
    </div>

    <!-- Level & Tag Color -->
    <div class="form-row">
      <div class="form-group">
        <label for="level">
          Niveau requis <span class="required">*</span>
        </label>
        <select id="level" formControlName="level">
          <option *ngFor="let level of levels" [value]="level.value">
            {{ level.label }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="tagColor">
          Couleur du tag <span class="required">*</span>
        </label>
        <select id="tagColor" formControlName="tagColor">
          <option *ngFor="let color of tagColors" [value]="color.value">
            {{ color.label }}
          </option>
        </select>
      </div>
    </div>

    <!-- Online Checkbox -->
    <div class="form-group">
      <label class="checkbox-label">
        <input type="checkbox" formControlName="online" />
        <span>Session en ligne (Discord, Roll20, etc.)</span>
      </label>
    </div>

    <!-- Actions -->
    <div class="form-actions">
      <button
        type="button"
        (click)="cancel()"
        class="button button--secondary"
        [disabled]="loading"
      >
        Annuler
      </button>
      <button
        type="submit"
        class="button button--primary"
        [disabled]="loading || sessionForm.invalid"
      >
        <span *ngIf="!loading">Créer la session</span>
        <span *ngIf="loading">Création en cours...</span>
      </button>
    </div>
  </form>
</div>
